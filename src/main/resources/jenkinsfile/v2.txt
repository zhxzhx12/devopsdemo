pipeline {

  agent any
  // def gradleHome

    environment {
        gradleHome = tool 'mylocalGradle'
    }

    stages {

      stage('Checkout Git') {
            steps {
              git 'https://github.com/zhxzhx12/devopsdemo.git'
            }
      }

      stage('Build') {
          steps {
            script {
            if (isUnix()) {
              sh "'${gradleHome}/bin/gradle' clean build -x test"
            } else {
              // bat(/"${mvnHome}\bin\mvn" -Dmaven.test.failure.ignore clean package/)
            }
            }
          }
      }

      stage('Test and Run Docker') {
          steps {
            sh "'${gradleHome}/bin/gradle' test "

            dir("build/test-results/test"){
              junit 'TEST-*.xml'
            }
        }
      }

      stage("Build Docker"){
        	steps{
        		echo "build docker"
        	}
      }

    }

}
